1. Script Form Tampilan Utama
Imports System.Math
Public Class tampilanUtama
    Dim gerakLatar, gerakMa, gerakMund As Integer 'indikator waktu untuk pergerakan
    Dim maxSatuGerak As Integer = 52 'maksimal satu gerakan
    Dim arahMa, arahMund As Integer '1=maju -1=mundur
    Dim gerLa, gerMa, gerMund As Integer 'indikator yang gerak
    Dim posisiMa As Integer = 0 'posisi ma
    Dim posisiMund As Integer = 0 'posisi mund
    Public masukanDadu As Integer 'masukan angka dadu
    Public totDaduMa As Integer = 0 'total dadu ma
    Public totDaduMund As Integer = 0 'total dadu mund
    Public giliran As Integer = 2 'ma dulu yang maju
    Dim hasilRandomSoal As Integer
    Dim dataAcak(15) As Integer
    Public banyakAcak As Integer = 0

    Dim objSoal = New kelasSoal

    Private Sub gerak()
        If gerMa = 1 Then 'ma yang gerak
            HScrollBar1.Enabled = False
            tombolMain.Enabled = False
            tombolMain.Text = ""
            gerakMa += 1
            ma.Location = New Point(ma.Location.X + arahMa, ma.Location.Y)
            If gerakMa = Abs(maxSatuGerak * masukanDadu) Then
                timerMa.Stop()
                gerMa = 0
            End If
            posisiMa = totDaduMa * maxSatuGerak
        End If
        If gerMund = 1 Then 'mund yang gerak
            HScrollBar1.Enabled = False
            tombolMain.Enabled = False
            tombolMain.Text = ""
            gerakMund += 1
            mund.Location = New Point(mund.Location.X + arahMund, mund.Location.Y)
            If gerakMund = Abs(maxSatuGerak * masukanDadu) Then
                timerMund.Stop()
                gerMund = 0
            End If
            posisiMund = totDaduMund * maxSatuGerak
        End If
            If gerMa = 0 And gerMund = 0 Then
                HScrollBar1.Enabled = True
                tombolMain.Enabled = True
            End If
        If giliran = 2 Then
            tombolMain.Text = "Ma"
        Else
            tombolMain.Text = "Mund"
        End If
    End Sub

    Private Sub seleksiGerak(ByVal status As Integer, ByVal nilai As Integer)
        If status = 1 And nilai < 0 Then
            timerMa.Start()
            arahMa = -1
            gerakMa = 0
            gerMa = 1
        ElseIf status = 1 And nilai > 0 Then
            timerMa.Start()
            arahMa = 1
            gerakMa = 0
            gerMa = 1
        ElseIf status = 2 And nilai < 0 Then
            timerMund.Start()
            arahMund = -1
            gerakMund = 0
            gerMund = 1
        ElseIf status = 2 And nilai > 0 Then
            timerMund.Start()
            arahMund = 1
            gerakMund = 0
            gerMund = 1
        End If
    End Sub
    Private Sub ma_Tick(sender As Object, e As EventArgs) Handles timerMa.Tick
        gerak()
    End Sub

    Private Sub mund_Tick(sender As Object, e As EventArgs) Handles timerMund.Tick
        gerak()
    End Sub

    Private Sub HScrollBar1_Scroll(sender As Object, e As ScrollEventArgs) Handles HScrollBar1.Scroll
        Dim posisi As Double = (HScrollBar1.Value / 100) * (latar.Width - Me.Width)
        latar.Location = New Point(-posisi, latar.Location.Y)
        ma.Location = New Point(-posisi + posisiMa + 19, ma.Location.Y)
        mund.Location = New Point(-posisi + posisiMund + 19, mund.Location.Y)
    End Sub

    Private Sub Utama_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        tombolMain.Text = "Ma"
    End Sub

    Private Function cekJawaban() As Boolean
        Dim posisi As Integer
        If giliran = 1 Then
            posisi = totDaduMa
        Else
            posisi = totDaduMund
        End If
        If objSoal.soal(hasilRandomSoal).jawaban = popUp.jawaban Then
            Return True
        End If
        Return False
    End Function
    Public Sub mainkan()
        Dim cekMa, cekMund As Integer
        If cekJawaban() Then
            cekMa = totDaduMa + masukanDadu
            cekMund = totDaduMund + masukanDadu
        Else
            If totDaduMa - masukanDadu < 1 Then
                masukanDadu = totDaduMa
            End If
            If totDaduMund - masukanDadu < 1 Then
                masukanDadu = totDaduMund
            End If
        End If
        If giliran = 1 Then
            If cekJawaban() = True Then
                totDaduMa = totDaduMa + masukanDadu
                seleksiGerak(1, masukanDadu)
            ElseIf cekJawaban() = False Then
                totDaduMa = totDaduMa - masukanDadu
                seleksiGerak(1, -masukanDadu)
            End If
        Else
            If cekJawaban() = True Then
                totDaduMund = totDaduMund + masukanDadu
                seleksiGerak(2, masukanDadu)
            ElseIf cekJawaban() = False Then
                totDaduMund = totDaduMund - masukanDadu
                seleksiGerak(2, -masukanDadu)
            End If
        End If
        If totDaduMa >= 50 Then
            MsgBox("Ma menang, atur ulang permainan", MsgBoxStyle.Information, "Ma Mund")
            aturUlang()
        ElseIf totDaduMund >= 50 Then
            MsgBox("Mund menang, atur ulang permainan", MsgBoxStyle.Information, "Ma Mund")
            aturUlang()
        End If
    End Sub

    Private Sub pergiliran()
        If giliran = 1 Then
            giliran = 2
        Else
            giliran = 1
        End If
    End Sub
    Private Function GetRandom(ByVal Min As Integer, ByVal Max As Integer) As Integer
        Dim a As Integer = New Random().Next(Min, Max)
        While a = 0 Or a = False
            a = GetRandom(Min, Max)
        End While
        Return a
    End Function
    Private Function acakSoal() As Integer
        Dim x As Integer
sini:
        x = GetRandom(1, 15)
        If cekRandomSoal(x) = True Then
            Return x
        Else
            GoTo sini
        End If
    End Function
    Private Function cekRandomSoal(ByVal tes As Integer) As Boolean
        For i = 1 To banyakAcak
            If dataAcak(i) = tes Then
                Return False
                Stop
            End If
        Next
        Return True
    End Function

    Private Sub tombolMain_Click(sender As Object, e As EventArgs) Handles tombolMain.Click
        If banyakAcak = 14 Then
            banyakAcak = 0
        End If
        pergiliran()
        masukanDadu = GetRandom(1, 6)
        hasilRandomSoal = acakSoal()
        banyakAcak += 1
        dataAcak(banyakAcak) = hasilRandomSoal
        popUp.angkaDadu.Text = "Hasil Acak Dadu " & masukanDadu
        popUp.soalKe = hasilRandomSoal
        popUp.awal()
        popUp.Show()
    End Sub

    Private Sub AturUlangToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles AturUlangToolStripMenuItem.Click
        aturUlang()
    End Sub
    Private Sub aturUlang()
        posisiMa = 0 'posisi ma
        posisiMund = 0 'posisi mund
        totDaduMa = 0 'total dadu ma
        totDaduMund = 0 'total dadu mund
        giliran = 2 'ma dulu yang maju
        banyakAcak = 0
        ma.Location = New Point(20, 148)
        mund.Location = New Point(20, 245)
    End Sub

    Private Sub CaraMainToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles CaraMainToolStripMenuItem.Click
        cara_main.Show()
        Me.Hide()
    End Sub

    Private Sub PermainanToolStripMenuItem1_Click(sender As Object, e As EventArgs) Handles PermainanToolStripMenuItem1.Click
        about.Show()
        Me.Hide()
    End Sub

    Private Sub ProgrammerToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles ProgrammerToolStripMenuItem.Click
        profile.Show()
        Me.Hide()
    End Sub
End Class


2. Script Form Pop Up
Public Class popUp
    Dim objSoal = New kelasSoal
    Public soalKe As Integer
    Public jawaban As String
    Dim tipe As Integer
    Public Sub awal()
        tipe = objSoal.soal(soalKe).tipe
        labelSoal.Text = objSoal.soal(soalKe).teks
        If tipe = 1 Then
            pilihanA.Visible = False
            pilihanB.Visible = False
            pilihanC.Visible = False
            pilihanD.Visible = False
            pilihanE.Visible = False
            isian.Visible = False
            tombolIsian.Visible = False
            pilihanBenar.Visible = True
            pilihanSalah.Visible = True
        ElseIf tipe = 2 Then
            pilihanBenar.Visible = False
            pilihanSalah.Visible = False
            isian.Visible = False
            tombolIsian.Visible = False
            pilihanA.Text = objSoal.soal(soalKe).pilihan(1)
            pilihanB.Text = objSoal.soal(soalKe).pilihan(2)
            pilihanC.Text = objSoal.soal(soalKe).pilihan(3)
            pilihanD.Text = objSoal.soal(soalKe).pilihan(4)
            pilihanE.Text = objSoal.soal(soalKe).pilihan(5)
            pilihanA.Visible = True
            pilihanB.Visible = True
            pilihanC.Visible = True
            pilihanD.Visible = True
            pilihanE.Visible = True
        ElseIf tipe = 3 Then
            pilihanA.Visible = False
            pilihanB.Visible = False
            pilihanC.Visible = False
            pilihanD.Visible = False
            pilihanE.Visible = False
            pilihanBenar.Visible = False
            pilihanSalah.Visible = False
            isian.Visible = True
            tombolIsian.Visible = True
        End If
    End Sub

    Private Sub lanjut()
        tampilanUtama.mainkan()
        Me.Hide()
        isian.Text = ""
    End Sub

    Private Sub pilihanA_Click(sender As Object, e As EventArgs) Handles pilihanA.Click
        jawaban = "1"
        lanjut()
    End Sub

    Private Sub pilihanB_Click(sender As Object, e As EventArgs) Handles pilihanB.Click
        jawaban = "2"
        lanjut()
    End Sub

    Private Sub pilihanC_Click(sender As Object, e As EventArgs) Handles pilihanC.Click
        jawaban = "3"
        lanjut()
    End Sub

    Private Sub pilihanD_Click(sender As Object, e As EventArgs) Handles pilihanD.Click
        jawaban = "4"
        lanjut()
    End Sub

    Private Sub pilihanE_Click(sender As Object, e As EventArgs) Handles pilihanE.Click
        jawaban = "5"
        lanjut()
    End Sub

    Private Sub pilihanBenar_Click(sender As Object, e As EventArgs) Handles pilihanBenar.Click
        jawaban = "1"
        lanjut()
    End Sub

    Private Sub pilihanSalah_Click(sender As Object, e As EventArgs) Handles pilihanSalah.Click
        jawaban = "0"
        lanjut()
    End Sub

    Private Sub tombolIsian_Click(sender As Object, e As EventArgs) Handles tombolIsian.Click
        jawaban = isian.Text
        lanjut()
    End Sub

    Private Sub popUp_Load(sender As Object, e As EventArgs) Handles MyBase.Load

    End Sub
End Class


3. Script Kelas Soal
Public Class kelasSoal
    Structure data
        Dim tipe As Integer '1=yes/no 2=pilgan 3=isian
        Dim teks As String 'teks soal
        Dim pilihan() As String 'pilihan untuk tipe soal 2
        Dim jawaban As String 'jawaban pertanyaan
    End Structure
    Public soal(15) As data
    Sub New()
        For i = 1 To 15
            ReDim soal(i).pilihan(5)
        Next
        soal(1).tipe = 1 ' ini untuk soal nomor 1, tipe yes/no
        soal(1).teks = "Jakarta adalah ibukota negara Indonesia"
        soal(1).jawaban = 1 'benar
        soal(2).tipe = 1 ' ini untuk soal nomor 2, tipe yes/no
        soal(2).teks = "2 x 4 + 2 adalah 12"
        soal(2).jawaban = 0 'salah
        soal(3).tipe = 1 ' ini untuk soal nomor 3, tipe yes/no
        soal(3).teks = "badminton adalah suatu olahraga raket yang dimainkan oleh dua orang atau dua pasangan yang saling berlawanan."
        soal(3).jawaban = 1 'benar
        soal(4).tipe = 1 ' ini untuk soal nomor 4, tipe yes/no
        soal(4).teks = "Mark Zuckerberg adalah pembuat media sosial facebook"
        soal(4).jawaban = 1 'benar
        soal(5).tipe = 1 ' ini untuk soal nomor 5, tipe yes/no
        soal(5).teks = "Selat malaka menghubungkan pulau jawa dan pulau sumatra"
        soal(5).jawaban = 0 'salah

        soal(6).tipe = 2
soal(6).teks = "Cabang ilmu yang membahas tentang makhluk hidup adalah ?"
        soal(6).pilihan(1) = "Statistika"
        soal(6).pilihan(2) = "Biologi"
        soal(6).pilihan(3) = "Morfologi"
        soal(6).pilihan(4) = "Bioteknologi"
        soal(6).pilihan(5) = "Biogeografi"
        soal(6).jawaban = 2
        soal(7).tipe = 2
        soal(7).teks = "Siapakah pencipta lagu Indonesia Raya?"
        soal(7).pilihan(1) = "Kusbini"
        soal(7).pilihan(2) = "Iwan Fals"
        soal(7).pilihan(3) = "Ismail Marzuki"
        soal(7).pilihan(4) = "W.R. Supratman"
        soal(7).pilihan(5) = "Susilo Bambanng Yudhoyono "
        soal(7).jawaban = 4
        soal(8).tipe = 2
        soal(8).teks = "Akar dari 49 adalah ?"
        soal(8).pilihan(1) = "9"
        soal(8).pilihan(2) = "8"
        soal(8).pilihan(3) = "7"
        soal(8).pilihan(4) = "6"
        soal(8).pilihan(5) = "5"
        soal(8).jawaban = 3
        soal(9).tipe = 2
        soal(9).teks = "Tanggal dan Bulan apakah hari lahirnya ibu RA. Kartini ?"
        soal(9).pilihan(1) = "21 Mei"
        soal(9).pilihan(2) = "25 Mei"
        soal(9).pilihan(3) = "21 Maret"
        soal(9).pilihan(4) = "25 April"
        soal(9).pilihan(5) = "21 April"
        soal(9).jawaban = 5
        soal(10).tipe = 2
        soal(10).teks = "Yang merupakan peralatan masukan (input device) adalah?"
        soal(10).pilihan(1) = "Mouse"
        soal(10).pilihan(2) = "Printer"
        soal(10).pilihan(3) = "Monitor"
        soal(10).pilihan(4) = "Speaker"
        soal(10).pilihan(5) = "Harddisk"
        soal(10).jawaban = 1

        soal(11).tipe = 3 ' ini untuk soal nomor 1,tipe isian
        soal(11).teks = "8 x 5 / 4 - 10 = ?"
        soal(11).jawaban = 0
        soal(12).tipe = 3 ' ini untuk soal nomor 2,tipe isian
        soal(12).teks = "Siapakah presiden RI yang ketiga ?"
        soal(12).jawaban = "BJ Habibie"
        soal(13).tipe = 3 ' ini untuk soal nomor 3,tipe isian
        soal(13).teks = "Samudra yang terluas di dunia adalah"
        soal(13).jawaban = "samudra pasifik"
        soal(14).tipe = 3 ' ini untuk soal nomor 4,tipe isian
        soal(14).teks = "Tari Kecak adalah tari tradisional yang berasala dari "
        soal(14).jawaban = "bali"
        soal(15).tipe = 3 ' ini untuk soal nomor 5,tipe isian
        soal(15).teks = "Bendera merah putih dijahit oleh "
        soal(15).jawaban = "Fatmawati"
    End Sub
End Class
